import{r as a,j as e}from"./index-BJ57Odm-.js";import{B as j}from"./Button-7Tz0rUHs.js";import{I as y,S as w,a as S,b,c as I,d as g}from"./select-0RswQJyk.js";import{d as k,u as P,c as F,g as L}from"./ItemService-BDk4lKjN.js";import{D as M,a as O,b as z,c as V,F as B,d as p,e as E,g as H}from"./CategoryService-CtDZpKyV.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";import"./classNames-6HTn5c6X.js";import"./isNil-Cy_hEUtT.js";import"./index-DbyFNifg.js";import"./utils-fzJQ3yUy.js";import"./createLucideIcon-BJHE781N.js";import"./index-B9g7qEXm.js";const R=({items:u,fetchItems:n,onEdit:r})=>{const[i,m]=a.useState(""),[o,c]=a.useState(!1),d=a.useCallback(async s=>{if(confirm("Are you sure you want to delete this item?")){c(!0);try{await k(s),await n()}catch(x){console.error(x)}finally{c(!1)}}},[n]);a.useEffect(()=>{n()},[]);const l=u.filter(s=>s.name.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(y,{placeholder:"Search item...",value:i,className:"max-w-xs",onChange:s=>m(s.target.value)})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.length>0?l.map(s=>{var x;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:((x=s.category)==null?void 0:x.name)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.formattedPrice||s.price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.isActive?"Active":"Inactive"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex justify-end space-x-2",children:[e.jsx(j,{size:"sm",variant:"default",onClick:()=>r(s),children:"Edit"}),e.jsx(j,{size:"sm",variant:"solid",onClick:()=>d(s._id),children:"Delete"})]})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:o?"Loading...":"No items found"})})})]})})]})},U=({isOpen:u,onClose:n,itemToEdit:r,onSuccess:i})=>{const[m,o]=a.useState(""),[c,d]=a.useState(""),[l,s]=a.useState(null),[x,v]=a.useState(0),[N,C]=a.useState(!0),[f,_]=a.useState([]),A=async()=>{try{const t=await H();_(t.data)}catch(t){console.error(t)}};a.useEffect(()=>{A()},[]),a.useEffect(()=>{r?(o(r.name),d(r.description||""),s(f.find(t=>{var h;return t._id===((h=r.category)==null?void 0:h._id)})||null),v(r.price),C(r.isActive)):(o(""),d(""),s(null),v(0),C(!0))},[r,f]);const D=async()=>{if(!(l!=null&&l._id)){alert("Please select a category");return}const t={name:m,description:c,category:l._id,price:x,isActive:N};try{r?await P(r._id,t):await F(t),i(),n()}catch(h){console.error(h)}};return e.jsx(M,{open:u,onOpenChange:t=>!t&&n(),children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{children:r?"Edit Item":"Create Item"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsx(p,{label:"Name",children:e.jsx(y,{value:m,onChange:t=>o(t.target.value)})}),e.jsx(p,{label:"Description",children:e.jsx(y,{value:c,onChange:t=>d(t.target.value)})}),e.jsx(p,{label:"Category",children:e.jsxs(w,{value:(l==null?void 0:l._id)??"none",onValueChange:t=>s(t==="none"?null:f.find(h=>h._id===t)||null),children:[e.jsx(S,{children:e.jsx(b,{placeholder:"Select Category"})}),e.jsxs(I,{children:[e.jsx(g,{value:"none",children:"None"}),f.map(t=>e.jsx(g,{value:t._id,children:t.name},t._id))]})]})}),e.jsx(p,{label:"Price",children:e.jsx(y,{type:"number",value:x,onChange:t=>v(Number(t.target.value))})}),e.jsx(p,{label:"Status",children:e.jsxs(w,{value:N?"active":"inactive",onValueChange:t=>C(t==="active"),children:[e.jsx(S,{children:e.jsx(b,{})}),e.jsxs(I,{children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"inactive",children:"Inactive"})]})]})})]}),e.jsxs(E,{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(j,{variant:"default",onClick:n,children:"Cancel"}),e.jsx(j,{onClick:D,children:r?"Update":"Create"})]})]})})},se=()=>{const[u,n]=a.useState(!1),[r,i]=a.useState(),[m,o]=a.useState([]),c=a.useCallback(async()=>{try{const s=await L();o(s.items)}catch(s){console.error(s)}},[]),d=()=>{i(void 0),n(!0)},l=s=>{i(s),n(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Items"}),e.jsx(j,{variant:"solid",size:"sm",onClick:d,children:"Create Item"})]}),e.jsx(R,{items:m,fetchItems:c,onEdit:l}),e.jsx(U,{isOpen:u,itemToEdit:r,onClose:()=>n(!1),onSuccess:c})]})};export{se as default};
