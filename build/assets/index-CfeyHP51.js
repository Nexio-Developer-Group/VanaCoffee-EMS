import{Q as v,r,j as e}from"./index-DGdLDHeG.js";import{B as j}from"./Button-DbTTkfwt.js";import{I as g,D as P,a as F,b as L,c as M,F as O,d as p,S as w,e as I,f as b,g as A,h as y,i as W,j as z}from"./CategoryService-DJZFUg7N.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";import"./classNames-CFtoky59.js";import"./isNil-4hYIrcAI.js";import"./utils-B5dMaeeU.js";import"./createLucideIcon-DWdFxCp9.js";async function V(n){return v.fetchDataWithAxios({url:"/item",method:"post",data:n})}async function B(n,l){return v.fetchDataWithAxios({url:`/item/${n}`,method:"put",data:l})}async function $(n){return v.fetchDataWithAxios({url:`/item/${n}`,method:"delete"})}async function E(n){return v.fetchDataWithAxios({url:"/item",method:"get",params:n})}const H=({items:n,fetchItems:l,onEdit:a})=>{const[o,m]=r.useState(""),[d,i]=r.useState(!1),x=r.useCallback(async s=>{if(confirm("Are you sure you want to delete this item?")){i(!0);try{await $(s),await l()}catch(h){console.error(h)}finally{i(!1)}}},[l]),c=n.filter(s=>s.name.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(g,{placeholder:"Search item...",value:o,className:"max-w-xs",onChange:s=>m(s.target.value)})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length>0?c.map(s=>{var h;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:((h=s.category)==null?void 0:h.name)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.formattedPrice||s.price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.isActive?"Active":"Inactive"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex justify-end space-x-2",children:[e.jsx(j,{size:"sm",variant:"default",onClick:()=>a(s),children:"Edit"}),e.jsx(j,{size:"sm",variant:"solid",onClick:()=>x(s._id),children:"Delete"})]})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:d?"Loading...":"No items found"})})})]})})]})},Q=({isOpen:n,onClose:l,itemToEdit:a,onSuccess:o})=>{const[m,d]=r.useState(""),[i,x]=r.useState(""),[c,s]=r.useState(null),[h,C]=r.useState(0),[S,N]=r.useState(!0),[f,D]=r.useState([]),_=async()=>{try{const t=await z();D(t.data)}catch(t){console.error(t)}};r.useEffect(()=>{_()},[]),r.useEffect(()=>{a?(d(a.name),x(a.description||""),s(f.find(t=>{var u;return t._id===((u=a.category)==null?void 0:u._id)})||null),C(a.price),N(a.isActive)):(d(""),x(""),s(null),C(0),N(!0))},[a,f]);const k=async()=>{if(!(c!=null&&c._id)){alert("Please select a category");return}const t={name:m,description:i,category:c._id,price:h,isActive:S};try{a?await B(a._id,t):await V(t),o(),l()}catch(u){console.error(u)}};return e.jsx(P,{open:n,onOpenChange:t=>!t&&l(),children:e.jsxs(F,{children:[e.jsx(L,{children:e.jsx(M,{children:a?"Edit Item":"Create Item"})}),e.jsxs(O,{className:"space-y-4",children:[e.jsx(p,{label:"Name",children:e.jsx(g,{value:m,onChange:t=>d(t.target.value)})}),e.jsx(p,{label:"Description",children:e.jsx(g,{value:i,onChange:t=>x(t.target.value)})}),e.jsx(p,{label:"Category",children:e.jsxs(w,{value:(c==null?void 0:c._id)??"none",onValueChange:t=>s(t==="none"?null:f.find(u=>u._id===t)||null),children:[e.jsx(I,{children:e.jsx(b,{placeholder:"Select Category"})}),e.jsxs(A,{children:[e.jsx(y,{value:"none",children:"None"}),f.map(t=>e.jsx(y,{value:t._id,children:t.name},t._id))]})]})}),e.jsx(p,{label:"Price",children:e.jsx(g,{type:"number",value:h,onChange:t=>C(Number(t.target.value))})}),e.jsx(p,{label:"Status",children:e.jsxs(w,{value:S?"active":"inactive",onValueChange:t=>N(t==="active"),children:[e.jsx(I,{children:e.jsx(b,{})}),e.jsxs(A,{children:[e.jsx(y,{value:"active",children:"Active"}),e.jsx(y,{value:"inactive",children:"Inactive"})]})]})})]}),e.jsxs(W,{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(j,{variant:"default",onClick:l,children:"Cancel"}),e.jsx(j,{onClick:k,children:a?"Update":"Create"})]})]})})},T=()=>{const[n,l]=r.useState(!1),[a,o]=r.useState(),[m,d]=r.useState([]),i=r.useCallback(async()=>{try{const s=await E();d(s.items)}catch(s){console.error(s)}},[]),x=()=>{o(void 0),l(!0)},c=s=>{o(s),l(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Items"}),e.jsx(j,{variant:"solid",size:"sm",onClick:x,children:"Create Item"})]}),e.jsx(H,{items:m,fetchItems:i,onEdit:c}),e.jsx(Q,{isOpen:n,itemToEdit:a,onClose:()=>l(!1),onSuccess:i})]})};export{T as default};
