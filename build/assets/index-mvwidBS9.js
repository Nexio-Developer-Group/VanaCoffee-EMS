import{Q as v,r as a,j as e}from"./index-BrUDqbzg.js";import{B as j}from"./Button-DNFdUz4y.js";import{I as g,D as P,a as F,b as L,c as M,F as O,d as p,S as w,e as I,f as b,g as A,h as y,i as W,j as z}from"./CategoryService-CgcgYHA_.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";import"./classNames-IiHkJyF-.js";import"./isNil-CqtpXHhp.js";import"./utils-Ixqy-AdN.js";import"./createLucideIcon-ChMA4_yk.js";async function V(n){return v.fetchDataWithAxios({url:"/item",method:"post",data:n})}async function B(n,l){return v.fetchDataWithAxios({url:`/item/${n}`,method:"put",data:l})}async function E(n){return v.fetchDataWithAxios({url:`/item/${n}`,method:"delete"})}async function $(n){return v.fetchDataWithAxios({url:"/item",method:"get",params:n})}const H=({items:n,fetchItems:l,onEdit:r})=>{const[o,u]=a.useState(""),[d,i]=a.useState(!1),x=a.useCallback(async s=>{if(confirm("Are you sure you want to delete this item?")){i(!0);try{await E(s),await l()}catch(h){console.error(h)}finally{i(!1)}}},[l]);a.useEffect(()=>{l()},[]);const c=n.filter(s=>s.name.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(g,{placeholder:"Search item...",value:o,className:"max-w-xs",onChange:s=>u(s.target.value)})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length>0?c.map(s=>{var h;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:((h=s.category)==null?void 0:h.name)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.formattedPrice||s.price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.isActive?"Active":"Inactive"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex justify-end space-x-2",children:[e.jsx(j,{size:"sm",variant:"default",onClick:()=>r(s),children:"Edit"}),e.jsx(j,{size:"sm",variant:"solid",onClick:()=>x(s._id),children:"Delete"})]})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:d?"Loading...":"No items found"})})})]})})]})},Q=({isOpen:n,onClose:l,itemToEdit:r,onSuccess:o})=>{const[u,d]=a.useState(""),[i,x]=a.useState(""),[c,s]=a.useState(null),[h,C]=a.useState(0),[S,N]=a.useState(!0),[f,D]=a.useState([]),_=async()=>{try{const t=await z();D(t.data)}catch(t){console.error(t)}};a.useEffect(()=>{_()},[]),a.useEffect(()=>{r?(d(r.name),x(r.description||""),s(f.find(t=>{var m;return t._id===((m=r.category)==null?void 0:m._id)})||null),C(r.price),N(r.isActive)):(d(""),x(""),s(null),C(0),N(!0))},[r,f]);const k=async()=>{if(!(c!=null&&c._id)){alert("Please select a category");return}const t={name:u,description:i,category:c._id,price:h,isActive:S};try{r?await B(r._id,t):await V(t),o(),l()}catch(m){console.error(m)}};return e.jsx(P,{open:n,onOpenChange:t=>!t&&l(),children:e.jsxs(F,{children:[e.jsx(L,{children:e.jsx(M,{children:r?"Edit Item":"Create Item"})}),e.jsxs(O,{className:"space-y-4",children:[e.jsx(p,{label:"Name",children:e.jsx(g,{value:u,onChange:t=>d(t.target.value)})}),e.jsx(p,{label:"Description",children:e.jsx(g,{value:i,onChange:t=>x(t.target.value)})}),e.jsx(p,{label:"Category",children:e.jsxs(w,{value:(c==null?void 0:c._id)??"none",onValueChange:t=>s(t==="none"?null:f.find(m=>m._id===t)||null),children:[e.jsx(I,{children:e.jsx(b,{placeholder:"Select Category"})}),e.jsxs(A,{children:[e.jsx(y,{value:"none",children:"None"}),f.map(t=>e.jsx(y,{value:t._id,children:t.name},t._id))]})]})}),e.jsx(p,{label:"Price",children:e.jsx(g,{type:"number",value:h,onChange:t=>C(Number(t.target.value))})}),e.jsx(p,{label:"Status",children:e.jsxs(w,{value:S?"active":"inactive",onValueChange:t=>N(t==="active"),children:[e.jsx(I,{children:e.jsx(b,{})}),e.jsxs(A,{children:[e.jsx(y,{value:"active",children:"Active"}),e.jsx(y,{value:"inactive",children:"Inactive"})]})]})})]}),e.jsxs(W,{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(j,{variant:"default",onClick:l,children:"Cancel"}),e.jsx(j,{onClick:k,children:r?"Update":"Create"})]})]})})},T=()=>{const[n,l]=a.useState(!1),[r,o]=a.useState(),[u,d]=a.useState([]),i=a.useCallback(async()=>{try{const s=await $();d(s.items)}catch(s){console.error(s)}},[]),x=()=>{o(void 0),l(!0)},c=s=>{o(s),l(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Items"}),e.jsx(j,{variant:"solid",size:"sm",onClick:x,children:"Create Item"})]}),e.jsx(H,{items:u,fetchItems:i,onEdit:c}),e.jsx(Q,{isOpen:n,itemToEdit:r,onClose:()=>l(!1),onSuccess:i})]})};export{T as default};
