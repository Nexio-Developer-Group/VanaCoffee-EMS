import{r,j as e}from"./index-DGdLDHeG.js";import{B as u}from"./Button-DbTTkfwt.js";import{j as w,k as I,I as f,D as _,a as L,b as F,c as M,F as O,d as j,S as y,e as C,f as v,g as N,h as g,i as P,u as z,l as V}from"./CategoryService-DJZFUg7N.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";import"./classNames-CFtoky59.js";import"./isNil-4hYIrcAI.js";import"./utils-B5dMaeeU.js";import"./createLucideIcon-DWdFxCp9.js";const B=({onEdit:d})=>{const[l,a]=r.useState([]),[i,x]=r.useState(""),[c,o]=r.useState(!1),n=r.useCallback(async()=>{o(!0);try{const t=await w();a(t.data)}catch(t){console.error(t)}finally{o(!1)}},[]),m=r.useCallback(async t=>{if(confirm("Are you sure you want to delete this category?"))try{await I(t),n()}catch(p){console.error(p)}},[n]);r.useEffect(()=>{n()},[n,m,d]);const h=l.filter(t=>t.name.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(f,{placeholder:"Search category...",value:i,className:"max-w-xs",onChange:t=>x(t.target.value)})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("caption",{className:"sr-only",children:"List of categories"}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Parent"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Active"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length>0?h.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.description||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.parentCategory||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.isActive?"Active":"Inactive"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex justify-end space-x-2",children:[e.jsx(u,{size:"sm",variant:"default",onClick:()=>d(t),children:"Edit"}),e.jsx(u,{size:"sm",variant:"solid",onClick:()=>m(t._id),children:"Delete"})]})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:c?e.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."}):"No categories found"})})})]})})]})},H=({isOpen:d,onClose:l,categoryToEdit:a,onSuccess:i})=>{const[x,c]=r.useState(""),[o,n]=r.useState(""),[m,h]=r.useState(null),[t,p]=r.useState(!0),[S,b]=r.useState([]),A=async()=>{try{const s=await w();b(s.data)}catch(s){console.error(s)}};r.useEffect(()=>{A()},[]),r.useEffect(()=>{a?(c(a.name),n(a.description||""),h(a.parentCategory||null),p(a.isActive)):(c(""),n(""),h(null),p(!0))},[a]);const D=async()=>{const s={name:x,description:o,parentCategory:m,isActive:t};try{a?await z(a._id,s):await V(s),i(),l()}catch(k){console.error(k)}};return e.jsx(_,{open:d,onOpenChange:s=>!s&&l(),children:e.jsxs(L,{children:[e.jsx(F,{children:e.jsx(M,{children:a?"Edit Category":"Create Category"})}),e.jsxs(O,{className:"space-y-4",children:[e.jsx(j,{label:"Name",children:e.jsx(f,{value:x,onChange:s=>c(s.target.value)})}),e.jsx(j,{label:"Description",children:e.jsx(f,{value:o,onChange:s=>n(s.target.value)})}),e.jsx(j,{label:"Parent Category",children:e.jsxs(y,{value:m??"none",onValueChange:s=>h(s==="none"?null:s),children:[e.jsx(C,{children:e.jsx(v,{placeholder:"None"})}),e.jsxs(N,{children:[e.jsx(g,{value:"none",children:"None"}),S.filter(s=>s._id!==(a==null?void 0:a._id)).map(s=>e.jsx(g,{value:s._id,children:s.name},s._id))]})]})}),e.jsx(j,{label:"Status",children:e.jsxs(y,{value:t?"active":"inactive",onValueChange:s=>p(s==="active"),children:[e.jsx(C,{children:e.jsx(v,{placeholder:"Select Status"})}),e.jsxs(N,{children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"inactive",children:"Inactive"})]})]})})]}),e.jsxs(P,{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(u,{variant:"default",onClick:l,children:"Cancel"}),e.jsx(u,{onClick:D,children:a?"Update":"Create"})]})]})})},Y=()=>{const[d,l]=r.useState(!1),[a,i]=r.useState(),x=()=>{i(void 0),l(!0)},c=o=>{i(o),l(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Categories"}),e.jsx(u,{variant:"solid",size:"sm",onClick:x,children:"Create Category"})]}),e.jsx(B,{onEdit:c}),e.jsx(H,{isOpen:d,categoryToEdit:a,onClose:()=>l(!1),onSuccess:()=>{}})]})};export{Y as default};
