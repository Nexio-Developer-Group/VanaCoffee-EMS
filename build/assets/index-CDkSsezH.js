import{r,j as e}from"./index-Cjg2RTOT.js";import{B as u}from"./Button-DWADcHlv.js";import{I as f}from"./Input-Bxhp507A.js";import{g as S,d as k,u as _,c as L}from"./CategoryService-BUVWBlWq.js";import{D as F,a as M,b as O,c as P,F as z,d as j,e as V}from"./FormItem-DtAGcQ3y.js";import{S as y,a as C,b as v,c as N,d as g}from"./select-B6aRnRrp.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";import"./classNames-XOZ0G2jQ.js";import"./isNil-BblksiF_.js";import"./index-CNCfuq4M.js";import"./utils-CFQnLGyy.js";import"./createLucideIcon-CQNGh5jU.js";import"./index-Cv7RYR2B.js";import"./floating-ui.react-dom-BznYKNqB.js";const B=({onEdit:d})=>{const[l,a]=r.useState([]),[i,x]=r.useState(""),[c,o]=r.useState(!1),n=r.useCallback(async()=>{o(!0);try{const s=await S();a(s.data)}catch(s){console.error(s)}finally{o(!1)}},[]),m=r.useCallback(async s=>{if(confirm("Are you sure you want to delete this category?"))try{await k(s),n()}catch(p){console.error(p)}},[n]);r.useEffect(()=>{n()},[n,m,d]);const h=l.filter(s=>s.name.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(f,{placeholder:"Search category...",value:i,className:"max-w-xs",onChange:s=>x(s.target.value)})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("caption",{className:"sr-only",children:"List of categories"}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Parent"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Active"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length>0?h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4",children:s.description||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.parentCategory||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.isActive?"Active":"Inactive"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex justify-end space-x-2",children:[e.jsx(u,{size:"xs",variant:"default",onClick:()=>d(s),children:"Edit"}),e.jsx(u,{size:"xs",variant:"solid",className:"bg-red-500 hover:bg-red-600 text-white",onClick:()=>m(s._id),children:"Delete"})]})]},s._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:c?e.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."}):"No categories found"})})})]})})]})},H=({isOpen:d,onClose:l,categoryToEdit:a,onSuccess:i})=>{const[x,c]=r.useState(""),[o,n]=r.useState(""),[m,h]=r.useState(null),[s,p]=r.useState(!0),[w,b]=r.useState([]),A=async()=>{try{const t=await S();b(t.data)}catch(t){console.error(t)}};r.useEffect(()=>{A()},[]),r.useEffect(()=>{a?(c(a.name),n(a.description||""),h(a.parentCategory||null),p(a.isActive)):(c(""),n(""),h(null),p(!0))},[a]);const D=async()=>{const t={name:x,description:o,parentCategory:m,isActive:s};try{a?await _(a._id,t):await L(t),i(),l()}catch(I){console.error(I)}};return e.jsx(F,{open:d,onOpenChange:t=>!t&&l(),children:e.jsxs(M,{children:[e.jsx(O,{children:e.jsx(P,{children:a?"Edit Category":"Create Category"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsx(j,{label:"Name",children:e.jsx(f,{value:x,onChange:t=>c(t.target.value)})}),e.jsx(j,{label:"Description",children:e.jsx(f,{value:o,onChange:t=>n(t.target.value)})}),e.jsx(j,{label:"Parent Category",children:e.jsxs(y,{value:m??"none",onValueChange:t=>h(t==="none"?null:t),children:[e.jsx(C,{children:e.jsx(v,{placeholder:"None"})}),e.jsxs(N,{children:[e.jsx(g,{value:"none",children:"None"}),w.filter(t=>t._id!==(a==null?void 0:a._id)).map(t=>e.jsx(g,{value:t._id,children:t.name},t._id))]})]})}),e.jsx(j,{label:"Status",children:e.jsxs(y,{value:s?"active":"inactive",onValueChange:t=>p(t==="active"),children:[e.jsx(C,{children:e.jsx(v,{placeholder:"Select Status"})}),e.jsxs(N,{children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"inactive",children:"Inactive"})]})]})})]}),e.jsxs(V,{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(u,{variant:"default",onClick:l,children:"Cancel"}),e.jsx(u,{onClick:D,children:a?"Update":"Create"})]})]})})},te=()=>{const[d,l]=r.useState(!1),[a,i]=r.useState(),x=()=>{i(void 0),l(!0)},c=o=>{i(o),l(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Categories"}),e.jsx(u,{variant:"solid",size:"sm",onClick:x,children:"Create Category"})]}),e.jsx(B,{onEdit:c}),e.jsx(H,{isOpen:d,categoryToEdit:a,onClose:()=>l(!1),onSuccess:()=>{}})]})};export{te as default};
